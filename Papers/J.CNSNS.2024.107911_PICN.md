# Physics-Informed ConvNet: Learning Physical Field from a Shallow Neural Network

作者: Shi pengpeng, Zeng zhi, Liang tianshou

## A.摘要

We introduce a novel methodology for solving nonlinear partial differential equation (PDE) on regular or irregular domains using physics-informed ConvNet, which we call the PICN. The network structure consists of three parts: 1) a convolutional neural network for physical field generation, 2) a pre-trained convolutional layer corresponding to the finite-difference filters to estimate differential fields of the generated physical field, and 3) an interpolation network for loss analysis in irregular geometry domains. From a CNN perspective, the physical field is generated by a deconvolution layer and a convolution layer. Unlike the standard Physics-informed Neural Network (PINN) approach, the convolutions corresponding to the finite-difference filters estimate the spatial gradients forming the physical operator and then construct the PDE residual in a PINN-like loss function. The total loss function involving boundary conditions and the physical con-straints in irregular geometry domains can be calculated from an efficient linear interpolation network. The theoretical analysis of PICN convergence is performed on a simplified case for solving a one-dimensional physical field, and several examples of nonlinear PDE of solutions with multifrequency characteristics are executed. The theory and examples confirm the effective learning capability of PICN for the physical field solution with high-frequency components,compared to the standard PINN. A series of numerical cases are performed to validate the current PICN, including the solving (and estimation) of nonlinear physical operator equations and recovering physical information from noisy observations. First, the ability of PICN to solve nonlinear PDE has been verified by executing three nonlinear problems including ODE with sine nonlinearity, PDE involving nonlinear sine-square operators, and Schr¨odinger equation. The proposed PICN has been assessed by solving some nonlinear PDE on irregular domains such as star-shaped domain, bird-like domain, and starfish domain. Moreover, PICN is applied to identify the thermal diffusivity parameters in an anisotropic heat transfer problem from noisy data, and a denoising display of the temperature field from strong noisy data with standard deviations ranging from 0.1 to 0.4. The numerical results demonstrate the high accuracy approximation and fast convergence performance of PICN. The potential advantage in approximating complex physical field with multi-frequency components indicates that PICN may become an alternative efficient neural network solver in physics-informed machine learning. This paper is adapted from the work originally posted on arXiv.com by the same authors (arXiv:2201.10967, Jan 26, 2022).The data and code accompanying this paper are publicly available at https://github.com/zengzhi2015/PICN.

## 1.引言

As a branch of artificial intelligence, machine learning uses algorithms to recognize basic information as well as abstract structures in data, and create predictive models [1]. Neural networks are important parts of machine learning algorithms. Neural networks, a computer program inspired by biological neural networks, can establish high-dimensional nonlinear empirical relationships between input and output variables by simulating the human brain processes information [2]. As an efficient data-driven model, deep learning based on multilayer neural networks has been successful in tasks such as computer vision, natural language processing, and game theory [3].Neural network algorithms for solving differential equations can be traced back to the 1990s [4–8]. Recently, a new class of deep learning networks called physics-informed neural network (PINN), has emerged as a very promising deep learning method for sci-entific computing problems [9–12]. The PINN encodes existing domain knowledge (the physical laws satisfied by physical field) into the network and builds a new generation of physics-informed machine learning, rather than relying solely on big data to infer the relationship between input and output. For the standard PINN, the PDE residual of governing equations satisfied by the physical field in the total loss function is constructed by automatic differentiation (AD) [13], and the neural network is trained to minimize the loss function determined by the residuals of the PDE, the boundary and the initial conditions, thus enabling the learning and solving PDE[9]. By combining physical information, PINN effectively reduces the amount of labeled data required for training, which allows PINN to be used not only for solving forward problems described by nonlinear PDE involved in physics and engineering problems but also for solving some inverse and optimization problems with only very few modifications to the corresponding code for the forward problems[14]. Existing advances have shown that PINN are a promising tool for a variety of mathematical and physical problems [15–18].Starting from the work of Maziar Raissi [9], PINN has received high attention and development [19–24], and some review papers have been reviewing and reporting on new works related to PINN in recent years [3,12,25-30].It is noteworthy that, in recent works, the main architectures covered in PINN tend to adopt connected feed-forward networks(called FNN, or also FF-DNN). However, the spectral bias nature of FNN leads to slow convergence of FNN-based PINN, which limits its performance in solving complex PDE [12]. The parameter sharing property of Convolutional neural networks (called ConvNet, or also CNN) allows them to learn spatial correlation efficiently with better scalability and faster convergence. Therefore, machine learning models based on CNN architectures have been proposed to solve the computational burden problem encountered with FNN-based PINN [31]. Recently, the ConvNet has been recognized as a powerful tool to analyze complex fluid flow phenomena [32–36]. For instance, the CNN machine-leaning-based super-resolution analysis can greatly enhance the spatial resolution [33–34]. CNN-based machine learning methods have also been successfully used to reasonably estimate fields in missing regions, and the velocity fields estimated by the learning model contain approximately 40 times the data density of traditional inter-correlation methods [35]. For CNN-based fluid flow analyses, the influence of various parameters and operations on the CNN performance are discussed with the utilization of an autoencoder [36]. It is worth noting that, similar to most machine learning methods, the above-mentioned CNN machine learning relies on a large amount of available data as input for training to extract the important features of high-dimensional and complex nonlinear fluid flows.
Because CNN was created for image recognition and was suitable for processing data similar to images, it was for a long time considered not directly applicable to scientific computing problems. In some recent pilot studies, PINN extensions have been inves-tigated based on CNN, called PICN. Unlike the standard PINN approach, when training CNN, finite-difference filters can be used to construct the differential equation residual in a PINN-like loss function [37,38]. By transforming the solution domain from an irregular physical domain to a rectangular reference domain using coordinate transformations, physics-informed geometry-adaptive convolu-tional neural networks were introduced to strictly enforce the boundary conditions of the irregular physical domain [39]. The small amount of PICN work has demonstrated the advantages of solving PDE [39,40], fundamental super-resolution [41], and physical field prediction without labeled data [42]. However, the development of PICN is still in a relatively early stage, and there is still a great demand for the improvement of convergence speed and calculation accuracy in solving forward and inverse problems, especially in model architecture and solution accuracy [43–45].This paper presents a physics-informed convolutional neural network for solving PDE, referred to as Physics-informed ConvNet or PICN. This PICN method can be regarded as a highly simplified upgrade of existing CNN-based deep learning methods for scientific computing [37–45]. As shown in our following discussion of numerical examples, the convergence quality of the present PICN is much better than that of the PINN, and the computational speed of PICN exceeds that of PINN by an order of magnitude. The main con-tributions of this paper are summarized. (1) A new PICN architecture is proposed for solving the forward and inverse problems of nonlinear PDE satisfied by the physical field on regular or irregular domains, where the physical field is generated by a deconvolution layer and a single convolution layer. The convolutions corresponding to the finite-difference filters are used to estimate the spatial gradients forming the physical operator and then construct the PDE residual in a PINN-like loss function. (2) An efficient linear interpolation network is constructed to compute the total loss function involving boundary conditions and physical constraints,realizing solving nonlinear PDE on irregular domains. (3) The convergence behavior of the CNN for complex physical field recon-struction is analyzed theoretically and some numerical examples. Unlike the spectral bias nature leads to slow convergence of PINN, the high-frequency components in the physical field are equally learned in the training of PICN. (4) A series of numerical experimental cases demonstrate the feasibility of PICN in two types of physics-informed machine learning problems containing data-driven solutions and data-driven discovery.
The rest of the paper is organized as follows. Section 2 presents the description of basic problems in deep learning of physical information. Section 3 introduces the PICN network architectures. Section 4 discusses its convergence properties in the frequency domain for PICN. Sections 5-7 present some numerical cases of solving various nonlinear PDE on regular or irregular domains, esti-mating the PDE of the physical field, and reconstructing and denoising the display of the physical field from noisy observations. The large number of numerical examples verify the effectiveness of the method. Finally, some remarks and conclusions are given in the last section.

## 3.方法

下图展示了 PICN 的网络架构. 由于 CNN 架构的优势, PICN 加速了收敛速度并提升了收敛质量. 
网络结构由三部分组成: 1. 卷积神经网络用于生成物理场; 2. 对应于有限差分滤波器的预训练卷积层用于估计生成的物理场的微分场 3. 插值网络用于不规则几何定义域中的损失分析.

第一部分使用包含一个反卷积层和一个卷积层的 CNN 用于近似未知物理场, 将该 CNN 称为 De-conv Net.
反卷积层用于从常数输入值生成一个隐藏场的估计.
第一部分的输入可以是一个随机矩阵或其他来源于先验知识的初始场.
为了简单起见, 此处采用常数 1. 然后使用反卷积层, 估计可以写为:
$$
    \mathbf{y}^h = \mathbf{w}^h * x^{in} + b^h \in\mathbb{R}^{M\times N}
$$
其中 $*$ 表示卷积操作, $x^{in}=1$, $\mathbf{w}^h = [w_{i,j}^h]\in\mathbb{R}^{M\times N}$ 表示权重, $b^h\in\mathbb{R}$ 是偏置向量. 激活函数采用线性函数.

隐藏场 $\mathbf{y}^h$ 传递给卷积层用于产生估计的物理场:
$$
    \hat{\mathbf{u}}=\sigma(\mathbf{y}^h*\mathbf{w}^o + b^o)\in\mathbb{R}^{M\times N}
$$
其中 $\mathbf{w}^o = [w_{i,j}^o]\in\mathbb{R}^{p\times q}$ 表示权重, $b^o\in\mathbb{R}$ 是偏置向量. $\hat{\mathbf{u}}$ 中的元素表示物理场在规则离散网格点的值. 需要注意的是卷积层使用了变换用于连接局部信息并加快收敛.

第二部分将自动微分技术替换为有限差分, 有限差分的数值格式可以通过泰勒展开获得, 且经典的有限差分方法在网格上计算物理场导数是相当有效. 对应于有限差分滤波器的预训练卷积层用于估计生成物理场的微分场. 空间梯度通过二维卷积有限差分滤波器进行近似和二阶有限差分类似.

和标准的 PINN 方法不同, 训练 CNN 时有限差分滤波器可以用于构造 PINN 类的损失函数的 PDE 残差. 需要强调的是 PICN 用于求解非线性 PDE 时用于计算微分场的卷积中的权重会被冻结且不参与训练. 当用于估计物理场算子时, CNN 权重可以参与训练. 和 FDM 类似 当 PICN 完成求解物理场的任务时, 预训练卷积层的权重不参与训练. 因此 PICN 可以视为传统 FDM 算法的扩展, 将 CNN 的特性充分应用.

第三部分中, 为了求解不规则定义域上的非线性 PDE, 值得注意的是所求解的物理场的定义域不是规则的矩形域. 因此可以构造一个包围不规则区域的矩形区域, 并分布均匀网格点. 因为不规则区域的边界点不一定正好在矩形域的网格上, 需要建立插值网络用于估计不规则区域的物理场的值. 此处采用一个双线性插值网络使用边界点所在网格的四个顶点进行插值. 对于光滑和均匀有界场, 随着网格加密, 插值误差趋于零. 

因为需要构造一个更大的矩形域这可能导致计算资源的浪费, 因此基于局部坐标变换提出了另一种方法, 将一般的不规则定义域转换为规则的. 然而这要求更复杂的转换技术和不规则定义域的细节. 相比之下, 插值网络不需要复杂的预处理. 

## 4.收敛


